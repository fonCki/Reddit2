@page "/CreateUser"
@using Entities.Model
@using Application.Contracts
@inject IUserDAO userDao
@inject NavigationManager NavMgr
<h3>CreateUser</h3>

<EditForm Model ="@newUser" OnValidSubmit="@AddNewUser">
    <DataAnnotationsValidator/> 
        <ValidationSummary/>
        <div class="form-group">
            <span>
                <label>User Id:</label>
            </span>
            <span>
                <InputText @bind-Value="newUser.UserName"/>
            </span>
        </div>
        <div class="form-group">
            <span>
                <label>Title:</label>
            </span>
            <span>
                <InputText type="password" @bind-Value="newUser.Password"/>
            </span>
        </div>
        <p class="actions">
            <button class="btn btn-outline-dark" type="submit">Create</button>
        </p>
    </EditForm>
    <label>@errorLabel</label>




@code {
    private User newUser = new User();
    private string errorLabel;
    
    private async Task AddNewUser()
    {
        errorLabel = "";
        try
        {
            Console.WriteLine(newUser.UserName);
            Console.WriteLine(newUser.Password);
            await userDao.AddUserAsync(newUser);
        }
        catch (Exception e)
        {
            errorLabel = e.Message;
            return;
        }
        
        NavMgr.NavigateTo("/Users");
    }
    
}